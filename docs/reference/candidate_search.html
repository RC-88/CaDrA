<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Candidate Search — candidate_search • CaDrA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Candidate Search — candidate_search"><meta property="og:description" content="Performs heuristic search on a set of binary features to determine whether there are features whose union is more skewed (enriched at the extremes) than either features alone. This is the main functionality of the CaDrA package."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CaDrA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Docs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/docs/scoring_functions.html">Scoring Functions</a>
    </li>
    <li>
      <a href="../articles/docs/permutation_based_testing.html">Permutation-Based Testing</a>
    </li>
    <li>
      <a href="../articles/docs/cadra_figure_5.html">Reproduce CaDrA Figures</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../news/index.html">Change Log</a>
</li>
<li>
  <a href="https://github.com/montilab/CaDrA">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Candidate Search</h1>
    <small class="dont-index">Source: <a href="https://github.com/montilab/CaDrA/blob/HEAD/R/candidate_search.R"><code>R/candidate_search.R</code></a></small>
    <div class="hidden name"><code>candidate_search.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs heuristic search on a set of binary features to determine whether there are features whose union is more skewed (enriched at the extremes) than either features alone. This is the main functionality of the CaDrA package.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">candidate_search</span><span class="op">(</span>
  <span class="va">ES</span>,
  <span class="va">input_score</span>,
  method <span class="op">=</span> <span class="st">"ks"</span>,
  custom_function <span class="op">=</span> <span class="cn">NULL</span>,
  custom_parameters <span class="op">=</span> <span class="cn">NULL</span>,
  alternative <span class="op">=</span> <span class="st">"less"</span>,
  metric <span class="op">=</span> <span class="st">"stat"</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  search_start <span class="op">=</span> <span class="cn">NULL</span>,
  top_N <span class="op">=</span> <span class="fl">1</span>,
  search_method <span class="op">=</span> <span class="st">"both"</span>,
  max_size <span class="op">=</span> <span class="fl">7</span>,
  best_score_only <span class="op">=</span> <span class="cn">FALSE</span>,
  do_plot <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ES</dt>
<dd><p>an expression set of binary features (required). It must be a <code>BioBase ExpressionSet</code> object. The rownames of the expression set must contain unique features which are used in the search.</p></dd>
<dt>input_score</dt>
<dd><p>a vector of continuous scores of a functional response of interest (required). The <code>input_score</code> must have names or labels that matches the colnames of the expression matrix.</p></dd>
<dt>method</dt>
<dd><p>a character string specifies a the scoring function that is used in the search. There are 4 options: (<code>"ks"</code> or <code>"wilcox"</code> or <code>"revealer"</code> (conditional mutual information from REVEALER) or <code>"custom"</code> (a customized scoring method)). Default is <code>ks</code>.</p></dd>
<dt>custom_function</dt>
<dd><p>if method is <code>"custom"</code>, specifies the customized function here. Default is <code>NULL</code>.</p></dd>
<dt>custom_parameters</dt>
<dd><p>if method is <code>"custom"</code>, specifies a list of arguments to be passed to the custom_function(). Default is <code>NULL</code>.</p></dd>
<dt>alternative</dt>
<dd><p>a character string specifies an alternative hypothesis testing (<code>"two.sided"</code> or <code>"greater"</code> or <code>"less"</code>). Default is <code>less</code> for left-skewed significance testing.</p></dd>
<dt>metric</dt>
<dd><p>a character string specifies a metric to search for best features. <code>"pval"</code> or <code>"stat"</code> may be used which corresponding to p-value or score statistic. Default is <code>pval</code>. Note: <code>Revealer</code> method only utilized score statistics values (no p-value).</p></dd>
<dt>weights</dt>
<dd><p>if method is <code>ks</code>, specifies a vector of weights will perform a weighted-KS testing. Default is <code>NULL</code>.</p></dd>
<dt>search_start</dt>
<dd><p>an integer specifies an index within the expression set object of which feature(s) to start the candidate search with. Default is <code>NULL</code>. If NULL, then the search starts with the top ranked feature. If an integer is specified (N, where N &lt; nrow(ES)), the search starts with the Nth best feature. If a string is specified, the search starts with the feature with this name (must be a valid row name in ES)</p></dd>
<dt>top_N</dt>
<dd><p>an integer specifies the number of features to start the search over, starting from the top 'N' features in each case. Default is <code>1</code>.</p></dd>
<dt>search_method</dt>
<dd><p>a character string specifies an algorithm to filter out the best features (<code>"forward"</code> or <code>"both"</code>). Default is <code>both</code> (i.e. backward and forward).</p></dd>
<dt>max_size</dt>
<dd><p>an integer specifies a maximum size that a meta-feature can extend to do for a given search. Default is <code>7</code>.</p></dd>
<dt>best_score_only</dt>
<dd><p>a logical value indicates whether or not the function should return only the score corresponding to the search results. Default is <code>FALSE</code>.</p></dd>
<dt>do_plot</dt>
<dd><p>a logical value indicates whether or not to plot the resulting evaluation matrix. Default is <code>TRUE</code>.</p></dd>
<dt>verbose</dt>
<dd><p>a logical value indicates whether or not to print the diagnostic messages. Default is <code>FALSE</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If <code>best_score_only</code> is set to <code>TRUE</code>, the function returns a list object with the score corresponding to the union of the search meta-feature. If <code>best_score_only</code> is set to <code>FALSE</code>, a list containing the ES object (pertaining to the returned meta-feature) as well as its corresponding score and observed input scores are returned.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="co"># Load R library</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biobase" class="external-link">Biobase</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Load pre-computed expression set</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim.ES</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># set seed</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Provide a vector of continuous scores for a target profile </span></span>
<span class="r-in"><span class="co"># The scores must have labels or names that match the colnames of expression matrix</span></span>
<span class="r-in"><span class="va">input_score</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">sim.ES</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">input_score</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim.ES</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Define additional parameters and run the function</span></span>
<span class="r-in"><span class="va">candidate_search_result</span> <span class="op">&lt;-</span> <span class="fu">candidate_search</span><span class="op">(</span></span>
<span class="r-in">  ES <span class="op">=</span> <span class="va">sim.ES</span>, input_score <span class="op">=</span> <span class="va">input_score</span>, method <span class="op">=</span> <span class="st">"ks"</span>, </span>
<span class="r-in">  alternative <span class="op">=</span> <span class="st">"less"</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, metric <span class="op">=</span> <span class="st">"pval"</span>, </span>
<span class="r-in">  search_start <span class="op">=</span> <span class="cn">NULL</span>, top_N <span class="op">=</span> <span class="fl">1</span>, search_method <span class="op">=</span> <span class="st">"both"</span>, </span>
<span class="r-in">  max_size <span class="op">=</span> <span class="fl">7</span>, best_score_only <span class="op">=</span> <span class="cn">FALSE</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://github.com/RC-88" class="external-link">Reina Chau</a>, <a href="https://github.com/katgit" class="external-link">Katia Bulekova</a>, <a href="https://github.com/vkartha" class="external-link">Vinay Kartha</a>, <a href="https://github.com/tetomonti" class="external-link">Stefano Monti</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

